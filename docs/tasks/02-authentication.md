# 2. 사용자 인증 시스템

## 📋 태스크 목록

### 2.1 Supabase Auth 설정
- [ ] Auth 제공자 설정 (이메일/비밀번호)
- [ ] 이메일 확인 설정
- [ ] 리다이렉트 URL 설정
- [ ] Auth 정책 및 템플릿 설정

**의존성**: 01-project-setup.md의 1.3, 1.4 완료 후  
**예상 소요 시간**: 1시간  
**우선순위**: 🔴 High

### 2.2 인증 컨텍스트 및 훅 구현
- [ ] AuthContext 생성 (`/lib/auth-context.tsx`)
  ```typescript
  interface AuthContextType {
    user: User | null;
    loading: boolean;
    signIn: (email: string, password: string) => Promise<void>;
    signUp: (email: string, password: string) => Promise<void>;
    signOut: () => Promise<void>;
  }
  ```
- [ ] useAuth 커스텀 훅 구현
- [ ] Supabase 클라이언트 설정 (`/lib/supabase.ts`)
- [ ] 세션 관리 및 토큰 갱신 로직

**의존성**: 2.1 완료 후  
**예상 소요 시간**: 3-4시간  
**우선순위**: 🔴 High

### 2.3 로그인 페이지 구현
- [ ] 로그인 페이지 라우트 (`/app/auth/login/page.tsx`)
- [ ] 로그인 폼 컴포넌트
  - [ ] 이메일 입력 필드
  - [ ] 비밀번호 입력 필드
  - [ ] 로그인 버튼
  - [ ] 회원가입 링크
- [ ] 폼 유효성 검사 (Zod 스키마)
- [ ] 에러 메시지 표시
- [ ] 로딩 상태 UI

**의존성**: 2.2 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🔴 High

### 2.4 회원가입 페이지 구현
- [ ] 회원가입 페이지 라우트 (`/app/auth/signup/page.tsx`)
- [ ] 회원가입 폼 컴포넌트
  - [ ] 이메일 입력 필드
  - [ ] 비밀번호 입력 필드
  - [ ] 비밀번호 확인 필드
  - [ ] 회원가입 버튼
  - [ ] 로그인 링크
- [ ] 폼 유효성 검사 (Zod 스키마)
- [ ] 이메일 중복 확인
- [ ] 비밀번호 강도 체크

**의존성**: 2.2 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🔴 High

### 2.5 인증 미들웨어 및 보호된 라우트
- [ ] 미들웨어 설정 (`middleware.ts`)
- [ ] 보호된 라우트 정의
- [ ] 인증되지 않은 사용자 리다이렉트
- [ ] AuthGuard 컴포넌트 구현
- [ ] 조건부 네비게이션 처리

**의존성**: 2.2 완료 후  
**예상 소요 시간**: 2-3시간  
**우선순위**: 🟡 Medium

### 2.6 프로필 관리 기본 기능
- [ ] 사용자 프로필 조회
- [ ] 프로필 정보 표시 컴포넌트
- [ ] 로그아웃 기능
- [ ] 계정 삭제 기능 (선택사항)

**의존성**: 2.2 완료 후  
**예상 소요 시간**: 2-3시간  
**우선순위**: 🟢 Low

### 2.7 이메일 확인 및 비밀번호 재설정
- [ ] 이메일 확인 페이지 (`/app/auth/confirm/page.tsx`)
- [ ] 비밀번호 재설정 요청 폼
- [ ] 비밀번호 재설정 페이지
- [ ] 이메일 템플릿 커스터마이징

**의존성**: 2.1 완료 후  
**예상 소요 시간**: 3-4시간  
**우선순위**: 🟢 Low

## 🎯 완료 기준
- [ ] 사용자가 이메일/비밀번호로 회원가입 가능
- [ ] 이메일 확인 후 로그인 가능
- [ ] 인증된 사용자만 보호된 페이지 접근 가능
- [ ] 로그아웃 기능 정상 동작
- [ ] 세션 관리 및 자동 갱신 동작

## 📱 UI/UX 고려사항
- [ ] 모바일 우선 반응형 디자인
- [ ] 접근성 (키보드 네비게이션, 스크린 리더)
- [ ] 로딩 상태 및 에러 상태 명확한 피드백
- [ ] 간단하고 직관적인 폼 디자인

## 🔒 보안 고려사항
- [ ] 비밀번호 강도 검증
- [ ] CSRF 공격 방지
- [ ] XSS 공격 방지 (입력값 검증)
- [ ] Rate limiting (무차별 대입 공격 방지)

## 📝 테스트 시나리오
- [ ] 정상적인 회원가입 플로우
- [ ] 잘못된 이메일 형식 입력
- [ ] 약한 비밀번호 입력
- [ ] 이미 존재하는 계정으로 가입 시도
- [ ] 잘못된 로그인 정보 입력
- [ ] 인증되지 않은 상태에서 보호된 페이지 접근

## 🔗 참고 링크
- [Supabase Auth 가이드](https://supabase.com/docs/guides/auth)
- [Next.js 미들웨어](https://nextjs.org/docs/app/building-your-application/routing/middleware)
- [React Hook Form](https://react-hook-form.com/get-started)
- [Zod 유효성 검사](https://zod.dev/)
