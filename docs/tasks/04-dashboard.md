# 4. 데이터 조회 및 대시보드

## 📋 태스크 목록

### 4.1 데이터 조회 API 구현
- [ ] Supabase 클라이언트 쿼리 함수 (`/lib/api/food-logs.ts`)
  ```typescript
  interface GetFoodLogsParams {
    userId: string;
    startDate?: Date;
    endDate?: Date;
    mealType?: string;
  }
  ```
- [ ] 날짜별 식단 기록 조회
- [ ] 끼니별 필터링 기능
- [ ] 페이지네이션 구현
- [ ] 실시간 데이터 동기화 (Supabase Realtime)

**의존성**: 01-project-setup.md의 1.4 완료 후  
**예상 소요 시간**: 3-4시간  
**우선순위**: 🔴 High

### 4.2 대시보드 메인 페이지 구현
- [ ] 대시보드 라우트 (`/app/dashboard/page.tsx`)
- [ ] 날짜 선택 컴포넌트
- [ ] 일별 요약 카드
  - [ ] 총 칼로리
  - [ ] 끼니 수
  - [ ] 주요 영양소 요약
- [ ] 빠른 통계 표시
- [ ] 최근 기록 미리보기

**의존성**: 4.1 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🔴 High

### 4.3 끼니별 분류 표시 컴포넌트
- [ ] 끼니 카테고리 탭 (아침/점심/저녁/간식)
- [ ] 각 끼니별 식단 목록
  - [ ] 음식 이미지 썸네일
  - [ ] 음식명 목록
  - [ ] 칼로리 정보
  - [ ] 기록 시간
- [ ] 빈 상태 UI (기록이 없을 때)
- [ ] 끼니별 필터링 기능

**의존성**: 4.1 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🔴 High

### 4.4 상세 식단 보기 모달/페이지
- [ ] 개별 식단 기록 상세 페이지 (`/app/dashboard/logs/[id]/page.tsx`)
- [ ] 원본 이미지 표시
- [ ] AI 분석 결과 상세 표시
  - [ ] 감지된 음식별 정보
  - [ ] 신뢰도 표시
  - [ ] 영양성분 상세 정보
- [ ] 수동 수정 기능 (선택사항)
- [ ] 삭제 기능

**의존성**: 4.1 완료 후  
**예상 소요 시간**: 3-4시간  
**우선순위**: 🟡 Medium

### 4.5 영양성분 요약 및 차트
- [ ] 일별 영양성분 요약 컴포넌트
  - [ ] 탄수화물/단백질/지방 비율
  - [ ] 일일 권장량 대비 섭취량
  - [ ] 주요 미네랄/비타민 (나트륨 등)
- [ ] 간단한 차트 구현 (차트 라이브러리 사용)
- [ ] 주간/월간 트렌드 표시
- [ ] 목표 대비 달성률 표시

**의존성**: 4.1 완료 후  
**예상 소요 시간**: 5-6시간  
**우선순위**: 🟡 Medium

### 4.6 검색 및 필터 기능
- [ ] 날짜 범위 선택기
- [ ] 끼니 타입 필터
- [ ] 칼로리 범위 필터
- [ ] 음식명 검색 기능
- [ ] 정렬 옵션 (날짜, 칼로리 등)
- [ ] 필터 상태 저장 (로컬 스토리지)

**의존성**: 4.1 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🟢 Low

### 4.7 데이터 내보내기 기능
- [ ] CSV 내보내기 기능
- [ ] PDF 리포트 생성
- [ ] 날짜 범위별 내보내기
- [ ] 영양성분 요약 포함
- [ ] 이메일 전송 기능 (선택사항)

**의존성**: 4.1-4.5 완료 후  
**예상 소요 시간**: 3-4시간  
**우선순위**: 🟢 Low

### 4.8 성능 최적화 및 캐싱
- [ ] React Query를 활용한 데이터 캐싱
- [ ] 무한 스크롤 구현
- [ ] 이미지 지연 로딩
- [ ] 가상화된 리스트 (react-window)
- [ ] 메모이제이션 최적화

**의존성**: 4.1-4.3 완료 후  
**예상 소요 시간**: 4-5시간  
**우선순위**: 🟢 Low

## 🎯 완료 기준
- [ ] 사용자가 날짜를 선택하여 해당 날짜의 식단 기록 조회 가능
- [ ] 끼니별로 자동 분류된 식단이 명확하게 표시됨
- [ ] 각 식단의 칼로리 및 영양성분 정보가 정확히 표시됨
- [ ] 일별 총 칼로리 요약이 올바르게 계산되어 표시됨
- [ ] 모바일에서 사용하기 편한 반응형 UI

## 📱 UI/UX 설계 원칙

### 정보 계층 구조
1. **최상위**: 날짜 및 일일 요약 (총 칼로리)
2. **중간**: 끼니별 분류 탭
3. **하위**: 개별 식단 아이템
4. **세부**: 영양성분 상세 정보

### 모바일 최적화
- [ ] 터치 친화적 인터페이스
- [ ] 스와이프 제스처 지원
- [ ] 적절한 터치 타겟 크기 (44px 이상)
- [ ] 세로 스크롤 중심 레이아웃

## 🗃️ 데이터 구조 및 타입 정의

```typescript
interface FoodLog {
  id: string;
  userId: string;
  imageUrl: string;
  mealType: '아침' | '점심' | '저녁' | '간식';
  analysisResult: {
    items: FoodItem[];
    summary: NutrientSummary;
  };
  totalCalories: number;
  loggedAt: string;
  createdAt: string;
}

interface DailySummary {
  date: string;
  totalCalories: number;
  mealCounts: {
    아침: number;
    점심: number;
    저녁: number;
    간식: number;
  };
  nutrients: NutrientSummary;
}
```

## 📊 차트 및 시각화

### 사용할 차트 라이브러리
- **Recharts**: React 친화적, 가벼움
- **Chart.js**: 풍부한 기능, 커스터마이징 가능

### 구현할 차트 타입
- [ ] 도넛 차트: 영양소 비율 (탄수화물/단백질/지방)
- [ ] 바 차트: 일별 칼로리 트렌드
- [ ] 라인 차트: 주간 평균 칼로리
- [ ] 프로그레스 바: 일일 목표 대비 달성률

## 📝 테스트 시나리오
- [ ] 데이터가 없는 날짜 선택
- [ ] 특정 끼니에만 데이터가 있는 경우
- [ ] 대용량 데이터 조회 (100+ 기록)
- [ ] 네트워크 오류 상황
- [ ] 날짜 범위 변경 시 데이터 업데이트
- [ ] 실시간 데이터 동기화 확인

## 🔗 참고 링크
- [Supabase 실시간 기능](https://supabase.com/docs/guides/realtime)
- [React Query 가이드](https://tanstack.com/query/latest)
- [Recharts 문서](https://recharts.org/en-US/)
- [React Window](https://github.com/bvaughn/react-window)
